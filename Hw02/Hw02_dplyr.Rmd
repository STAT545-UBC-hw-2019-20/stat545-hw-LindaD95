---
title: "Assignment 2"
output: 
  html_document: 
    keep_md: true 
editor_options: 
  chunk_output_type: inline
---

```{r allow errors, echo = FALSE}
knitr::opts_chunk$set(error = TRUE)
```

```{r load packages, warning = FALSE, message = FALSE}
# load your packages here:
library(gapminder)
library(tidyverse)
``` 

## Exercise 1: Basic dplyr

#### Exercise 1.2 

Use the pipe operator %>% to select “country” and “gdpPercap” from your filtered dataset in 1.1 

```{r} 
gapminder %>%
filter(country %in%  c("Australia", "Canada", "Germany")) %>% 
  group_by(country) %>% 
  slice(5:6) %>%
  select(country, year, gdpPercap) 
```

#### Exercise 1.3 

Filter gapminder to all entries that have experienced a drop in life expectancy. 

delta_lifeExp is the change in life exptancy from 3 years prior to the the value in the year column. 

``` {r} 

gapminder %>% 
  mutate(lifeExp, lag_lifeExp = lag(lifeExp)) %>% 
  mutate(lifeExp, delta_lifeExp = lifeExp - lag_lifeExp) %>%
  select(country, year, delta_lifeExp) %>%
  drop_na(delta_lifeExp)
  
```

The data was then sorted to display the countries that experienced the largest drop in life expectancy from 2002 to 2007 at the top of the table. 

``` {r}
gapminder %>% 
  mutate(lifeExp, lag_lifeExp = lag(lifeExp)) %>% 
  mutate(lifeExp, delta_lifeExp = lifeExp - lag_lifeExp) %>%
  filter(delta_lifeExp < 0) %>%
  arrange(-desc(delta_lifeExp)) %>% 
  select(country, year, delta_lifeExp) %>%
  drop_na(delta_lifeExp)
```

``` {r}
gapminder %>% 
  mutate(lifeExp, lag_lifeExp = lag(lifeExp)) %>% 
  mutate(lifeExp, delta_lifeExp = lifeExp - lag_lifeExp) %>%
   filter(year == 2007) %>%
  arrange(-desc(delta_lifeExp)) %>% 
  select(country,delta_lifeExp) %>%
  drop_na(delta_lifeExp) %>%
  rename(delta_lifeExp_2002_2007 = delta_lifeExp)
```

### Exercise 1.4 

Filter gapminder so that it shows the max GDP per capita experienced by each country. 

``` {r}
gapminder %>% 
  group_by(country) %>%
  filter(gdpPercap == max(gdpPercap)) %>% 
  select(country, year, gdpPercap) %>%
  rename(Max_GDPperCap = gdpPercap)

```

### Exercise 1.5 

Produce a scatterplot of Canada’s life expectancy vs. GDP per capita using ggplot()

```{r}
gapminder %>%
  filter(country == 'Canada') %>%
  ggplot(aes(lifeExp, log(gdpPercap))) +
  geom_point()
# want to add labels corresonding to the year for each point 
``` 

# Exercise 2 

### Categorical Variable Exploration 

Exploring the GDP per capita (gdpPercap) for the countries in Asia for the year 2007. The GDP per capita is stated in USD. 

**Maximum GDP Per Capita**

``` {r}
max <- gapminder %>%  # was, trying to show the higest and the lowest gdppercap in 1 table 
  filter(continent == 'Asia') %>%
  filter(year == 2007) %>%
  group_by(country) %>%
  summarize(gdpPercap = max(gdpPercap)) %>%
  top_n(1)  
```

**Minimum GDP Per Capita**

``` {r}
min <- gapminder %>%  # was, trying to show the higest and the lowest gdppercap 
  filter(continent == 'Asia') %>%
  filter(year == 2007) %>%
  group_by(country) %>%
  summarize(gdpPercap = max(gdpPercap)) %>%
  top_n(-1)  
```

** Would like to store values and then plot 

** The average GDP per Capita for the year 2007 ** 

``` {r} 
avg <- gapminder %>%  
  filter(continent == 'Asia') %>%
  filter(year == 2007) %>%
  summarize(gdpPercap = mean(gdpPercap)) 
```

Myanmar's GDP per capita is approximately 2 % that of Kuwait. 

``` {r}
  round(min/max*100, 0)
```

| Country  | GDP per Capita in 2007 | 
-------------------------------------
| Myanmar  | 944 |
| Kuwait   | 47307 |


